jQuery(document).ready(function(n){"use strict";n.wc_variotion_images={init:function(){n("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){n.wc_variotion_images.add_images_box()}),n("#variable_product_options").on("woocommerce_variations_added",function(){n.wc_variotion_images.add_images_box()})},add_images_box:function(){n(".woocommerce_variation").each(function(){var i=n(this).find(".options");n(this).find(".wpwvi-gallery-wrapper").insertBefore(i)})},upload_images:function(i){i.preventDefault();var t=n(this).data("wpwvi_variation_id");if(n.wc_variotion_images.is_cross_upload_limit(t))return alert("Upload limit 3 images in free version"),!1;var a=n(this),o=wp.media.frames.file_frame=wp.media({title:wpwvi.variation_image_title,button:{text:wpwvi.add_variation_image_text},library:{type:["image","video"]},multiple:!0});o.on("select",function(){var i=o.state().get("selection").toJSON();if(3<n("#wpwvi-image-list-"+t+"li").length+i.length)return alert("Upload limit 3 images in free version"),!1;var e=i.map(function(i){var e=i.id,a=i.sizes.thumbnail.url;return wp.template("wpwvi-image")({image_id:e,image_url:a,variation_id:t})}).join("");a.parent().prev().find(".wpwvi-image-list").append(e),n.wc_variotion_images.variation_change_trigger(a)}),o.open()},variation_change_trigger:function(i){i.closest(".woocommerce_variation").addClass("variation-needs-update"),n("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled"),n("#variable_product_options").trigger("woocommerce_variations_input_changed")},remove_images:function(i){var e=n(this);i.preventDefault(),n.wc_variotion_images.variation_change_trigger(e),n(this).parent().remove()},is_cross_upload_limit:function(i){return 3<=n("#wpwvi-image-list-"+i+" li").length}},n.wc_variotion_images.init(),n(document).on("click",".wpwvi-add-image",n.wc_variotion_images.upload_images),n(document).on("click",".wpwvi-remove-image",n.wc_variotion_images.remove_images)});